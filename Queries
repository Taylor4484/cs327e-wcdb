# -*- coding: utf-8 -*-
1. Which people are associated with more than one crisis?

Select first_name, middle_name, last_name
    From Person
    Where id in
	(select id_person as id
	    From PersonCrisis 
            Where count(id) > 1);

2. For the past 5 decades, which countries had the most world crises per decade?

Select country
    From Location join Crisis
    Where id in
	(select id
	    From Crisis 
	    Where start_date >= 1963-01-01)
    Group by Country
    Order by start_date;

3. What is the average death toll of accident crises?

Select average(number)
    From HumanImpact
    Where crisis_id in
	(select id as crisis_id
	    from Crisis
	    Where kind = ‘ACC’);

4. What is the average death toll of world crises per country?

Select average(number), country
    From HumanImpact as S join Location as R
    On s.crisis_id = R.id
    Group by country;
	
5. What is the most common resource needed for different types of disasters?

Select description, count(*) 
    From Crisis as S join ResourceNeeded as R on S.id = R.crisis_id
    Group by name;

6. How many persons are related to crises located in countries other than their own?

Select count(distinct ids)
	From Person as join Location join PersonCrisis join Crisis
	Where Person.id = Location.id=PersonCrisis.id_person and crisis.id=Location.id;


7. How many crises occurred during the 1960s?

Select count(name)
	From Crisis
	Where start_date > 1959-01-01 and start_date < 1970-01-01;

8. Which orgs are located outside the United States and were involved in > 1 crisis?

Select name 
	From Organization join Location
	Where County != United States and id in
            (select id_organization as id 
                from CrisisOrganization
                Where count(id_organization)> 1);

9. Which Orgs, Crises, and Persons have the same location?

Select R.name, S.name, T.person, Country
    From Organization as R join Crisis as S join Person as T join Location as U
    On S.id=U.id and R.id=U.id and T.id=U.id
    Order by Country;

10. Which crisis has the minimum Human Impact?

Select name
    From Crisis 
    Where id in
        (Select crisis_id as id
	    From HumanImpact
	    Where number < ALL);

11. Count the number of crises that each organization helped

Select name, count(distinct  id_crisis)
    From CrisisOrganization as S join Organization as R 
    on S.id_organization= R.id;

12. Name and Postal Address of all orgs in California

Select name, street address, locality, region, postal_code
    From Organization
    Where id in
	(Select id
	    From Location
	    Where region = ‘California’);

13. List all crises that happened in the same state/region

Select name, region
    From Crisis natural join Location
    Order by region;

14. Find the total number of human casualties caused by crises in the 1990s

Select count(number)
    From HumanImpact
    Where crisis_id in
	(Select id as crisis_id
	    From Crisis
	    Where start_date >= 1990-01-01 and start_date < 2000-01-01);

15. Find the organization(s) that has provided support on the most Crises

Select name 
    From Organization
    Where id in
	(Select organization_id as id
	    From Crisis Organization
	    Where count(organization_id) > ALL)
